<html dir="ltr" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<META HTTP-EQUIV="assetid" CONTENT="HV05199211">
<META NAME="lcid" CONTENT="1033">
<title>IPhreeqcCOM Object</title>
<link rel="stylesheet" type="text/css" href="office10.css">
<script type="text/javascript" language="Javascript" src="sExpCollapse.js"></script>
<script type="text/javascript" language="JavaScript" src="inline.js"></script>
</head>
<body><h1>IPhreeqcCOM Object</h1>
<div class="ofvbanav">
<!--
<span class="ofvbanavreuse" id="seealso" onclick="toggleList()" onkeypress="toggleList()">
</span>
-->
<span class="ofvbanavreuse" id="properties" onclick="toggleList()" onkeypress="toggleList()">
</span>
<span class="ofvbanavreuse" id="methods" onclick="toggleList()" onkeypress="toggleList()">
</span>
<span class="ofvbanavreuse" id="events" onclick="toggleList()" onkeypress="toggleList()">
</span>
<!--
<span class="ofvbanavreuse" id="specifics" onclick="toggleList()" onkeypress="toggleList()">
</span>
-->
</div>
<table class="ofvbaomart">
<tr><td class="noborder" nowrap="true"><A HREF="objIPhreeqc.htm" title="IPhreeqcCOM"><SPAN class="omblue">IPhreeqcCOM</SPAN></A>
<br />
<!--
<IMG SRC="../img/space.gif" BORDER="0">
</IMG>
<IMG SRC="../img/parchild.gif" BORDER="0">
</IMG>
<SPAN class="ombluedash" id="ChildObjects" onclick="toggleList()" title="Multiple objects" tabindex="0">Multiple objects</SPAN>
<BR /></td>
</tr>
-->
</table>

<h2>Using the IPhreeqcCOM Object</h2>

The following example creates an IPhreeqcCOM object, loads the <b class="bterm"><I>phreeqc.dat</I></b> &nbsp;database and runs the <b class="bterm"><I><a class="ofvbanavex" href="ex1.htm">ex1</a></I></b> &nbsp;example.

<!-- Powershell Example -->
<div style="background-color:#ddd;padding-top:0px;padding-left:3px;padding-right:3px;padding-bottom:0px"><pre>
<div style="background-color:#ddd;padding-top:3px;padding-left:3px;padding-right:3px;padding-bottom:3px;white-space:nowrap;border-bottom:solid 1px #aaa;height:15px;word-spacing:normal;letter-spacing:normal">
  Powershell</div>
  [System.IO.Directory]::SetCurrentDirectory("$(Get-Location)")
  $iphreeqc = New-Object -ComObject IPhreeqcCOM.Object
  $iphreeqc.LoadDatabase("phreeqc.dat")
  $iphreeqc.OutputFileOn = $true
  $iphreeqc.OutputFileName = "ex1.out"
  if ($iphreeqc.RunFile("ex1") -eq 0) {
      Write-Host "see $($iphreeqc.OutputFileName)."
  }</pre></div>
  
<!-- JScript Example -->
<div style="background-color:#ddd;padding-top:0px;padding-left:3px;padding-right:3px;padding-bottom:0px"><pre>
<div style="background-color:#ddd;padding-top:3px;padding-left:3px;padding-right:3px;padding-bottom:3px;white-space:nowrap;border-bottom:solid 1px #aaa;height:15px;word-spacing:normal;letter-spacing:normal">
  JScript</div>
var iphreeqc = new ActiveXObject("IPhreeqcCOM.Object");
iphreeqc.LoadDatabase("phreeqc.dat");
iphreeqc.OutputFileOn = true;
if (iphreeqc.RunFile("ex1") == 0) {
    WScript.Echo("see " + iphreeqc.OutputFileName + ".");
}</pre></div>

<!-- VBScript Example -->
<div style="background-color:#ddd;padding-top:0px;padding-left:3px;padding-right:3px;padding-bottom:0px"><pre>
<div style="background-color:#ddd;padding-top:3px;padding-left:3px;padding-right:3px;padding-bottom:3px;white-space:nowrap;border-bottom:solid 1px #aaa;height:15px;word-spacing:normal;letter-spacing:normal">
  VBScript (Deprecated)</div>
Dim iphreeqc
Set iphreeqc = CreateObject("IPhreeqcCOM.Object")
iphreeqc.LoadDatabase("phreeqc.dat")
iphreeqc.OutputFileOn = True
If (iphreeqc.<b class="bterm">RunFile</b>("ex1") = 0) Then
    WScript.Echo("see " & iphreeqc.OutputFileName & ".")
End If</pre></div>

<h2>Remarks</h2>
Unlike the batch version of phreeqc, the output will be created in the file <a class="ofvbalink" href="proOutputFileName.htm">OutputFileName</a>.  If the <a class="ofvbalink" href="proOutputFileOn.htm">OutputFileOn</a> property were not set to <b class="bterm">True</b> no output files would have been created.

<script type="text/javascript" language="JScript" src="ofvbanl.js">
</script>
<span id="ofVBAISpan" class="ofvbaispan">
<iframe id="ofVBAIFrame" frameborder="0" marginheight="0" marginwidth="4" scrolling="auto" width="100%" src="../links/objIPhreeqc_l.htm"></iframe>
</span>
</body>
</html>